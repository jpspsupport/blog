---
title: Teams に投稿された SharePoint リンクが開かない問題について
date: 2025-09-09
tags:
  - SharePoint Online
---

特定の条件下で、Teams に投稿された SharePoint へのハイパーリンクが開かない事象が発生することがあります。これは複数の製品が関係しており、特定の URL 構造とセキュリティ機能が影響しています。

## 前提条件
この問題は、以下の条件が重なった場合に発生する可能性があります。

*   SharePoint サイトのフォルダー名が「数字+ピリオド+日本語」の形式である
*   Teamsクライアントに絶対パスの URL を貼り付けて投稿した際、URLに xsdata 以降の文字列が自動的に付与される(*)

(*) xsdata 以降の文字列は、Microsoft Defender for Office 365 の ATP（Advanced Threat Protection） による既定の動作です。

## Teams ATP（Advanced Threat Protection）とは？

ATP は、Microsoft Defender for Office 365 の一部として提供されるセキュリティ機能で、Microsoft Teams、SharePoint Online、OneDrive にアップロード・共有されるファイルやリンクに対して、マルウェアや悪意あるリンクの検出・防御を行います。
Teams で共有される SharePoint Online のリンクはブラウザで開かれるため、Safe Links 機能による検査が必要です。

## 再現手順
1.  SharePoint のライブラリを作成し、以下のようなフォルダー構成を用意します。

    「10.TESTフォルダー」 → 「2025年度」 → 「7月出張」
2. 「2025年度」フォルダーに移動した状態で、「7月出張」フォルダーの [・・・] → [詳細] → [パス] の右にある [直接リンクをコピーする] をクリックして、「7月出張」フォルダーの絶対パスを取得します。

3.   取得した URL を Teams クライアントに貼り付けて投稿します。

4.  Teams 上でリンクをクリックし、ブラウザーで SharePoint サイトを開きます

## 現象

リンク内の日本語部分が Unicode エスケープされることで、以下の問題が発生します

*   「レンダリングで不明なエラーが発生しました」と表示される
*   フォルダー名の日本語部分が Unicode エスケープされた状態で表示される

## 期待される動作

*   日本語部分が Unicode エスケープされず、正しいフォルダー名が表示される   
*   レンダリング エラーが発生しない

## 対処方法

1.  フォルダー名に「数字 + ピリオド + 日本語」の組み合わせを使用することを避ける
2.  フォルダー URL の取得方法を変更する（絶対パスではなく、以下の方法を推奨）：
    
    a) フォルダーの [・・・] → [リンクのコピー] をクリック
    
    b) 表示される選択画面上で、リンクの種類を選択します。
    * 共有する範囲を変更したくない場合、[既存のアクセス権をもつユーザー専用] を選択します。

    c) [適用] → [リンクのコピー] をクリックします。


<br>
今回の記事は以上となります。 ご不明点等がありましたら、弊社サポート サービスまでお気軽にお問い合わせください。