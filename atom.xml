<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Japan SharePoint Support Blog</title>
  
  <subtitle>日本マイクロソフトの SharePoint に関するサポート情報のブログです。</subtitle>
  <link href="https://jpspsupport.github.io/blog/atom.xml" rel="self"/>
  
  <link href="https://jpspsupport.github.io/blog/"/>
  <updated>2022-06-20T04:12:12.503Z</updated>
  <id>https://jpspsupport.github.io/blog/</id>
  
  <author>
    <name>SharePoint Support Japan</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>構成キャッシュの再作成 (SharePoint Server)</title>
    <link href="https://jpspsupport.github.io/blog/sharepoint-server/clear-configcache/"/>
    <id>https://jpspsupport.github.io/blog/sharepoint-server/clear-configcache/</id>
    <published>2022-06-19T15:00:00.000Z</published>
    <updated>2022-06-20T04:12:12.503Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>本投稿は、以前の <a href="https://social.msdn.microsoft.com/Forums/ja-JP/590627a7-d369-47b2-bfc8-7726d7cf9342/2708325104124611251512483124711251712398208772031625104?forum=sharepointsupportteamja" title="構成キャッシュの再作成">SharePoint サポート フォーラムの投稿</a> を元に、内容を一部加筆・修正したものとなります。</p></blockquote><blockquote><p>本投稿は、オンプレミスの SharePoint Server 2013, SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition に適用されます。Microsoft 365 の SharePoint Online には適用されませんので、ご注意ください。</p></blockquote><p>SharePoint Server では、パフォーマンスの観点から、SharePoint の構成データベース (SharePoint_Config) のデータの大部分を、SharePoint サーバー上のローカルのファイル システム内に XML ファイルとしてキャッシュ (構成キャッシュ) を保持しています。</p><p><a href="https://docs.microsoft.com/ja-jp/sharepoint/technical-reference/database-types-and-descriptions#configuration" title="データベースの種類と説明 (SharePoint Server)">データベースの種類と説明 (SharePoint Server)</a></p><p>構成キャッシュは、SharePoint Timer Service (SPTimerV4 / OWSTIMER.EXE) によるタイマー ジョブの実行の際に使用するキャッシュ情報となります。この構成キャッシュの内容に不整合が生じた場合、様々な問題が発生することが過去事例より確認されております。</p><p>&lt;一例&gt;</p><ul><li>SharePoint の各タイマー ジョブが正常に実行されない (“即時の通知” による通知メールが送信されない、SharePoint の診断ログの出力レベルの変更コマンド内容が正常に反映されない、ソリューションの取り消しが行えない、等)</li><li>検索関連の問題が発生する (クロールが開始・完了しない、インデックス リセットが行えない、検索トポロジーの変更ができない、等)</li><li>サイトのアクセスが行えない</li><li>新規のサイト コレクションを作成できない</li></ul><p>上記の事象は、あくまでも構成キャッシュの不整合によって発生した事象の一例となります。弊社サポートにお問合せいただいた際に、構成キャッシュの不整合が疑われるような状況の場合、はじめに弊社サポートからは構成キャッシュの再作成を依頼させていただくことがございます。<br>本投稿では、構成キャッシュの再作成の手順について、具体的な手順をご案内いたします。</p><hr><p>目次</p><ul><li><a href="#%E6%89%8B%E5%8B%95%E3%81%AB%E3%82%88%E3%82%8B%E6%A7%8B%E6%88%90%E3%82%AD%E3%83%A3%E3%83%83%E3%82%B7%E3%83%A5%E3%81%AE%E5%86%8D%E4%BD%9C%E6%88%90%E6%89%8B%E9%A0%86">手動による構成キャッシュの再作成手順</a><ul><li><a href="#%E4%BD%9C%E6%A5%AD%E3%81%AB%E3%82%88%E3%82%8B%E5%BD%B1%E9%9F%BF">作業による影響</a></li><li><a href="#%E4%BD%9C%E6%A5%AD%E5%AF%BE%E8%B1%A1">作業対象</a></li><li><a href="#%E4%BD%9C%E6%A5%AD%E6%89%8B%E9%A0%86">作業手順</a></li></ul></li><li><a href="#%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%88%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%9F%E6%A7%8B%E6%88%90%E3%82%AD%E3%83%A3%E3%83%83%E3%82%B7%E3%83%A5%E3%81%AE%E5%86%8D%E4%BD%9C%E6%88%90%E6%89%8B%E9%A0%86">スクリプトを使用した構成キャッシュの再作成手順</a><ul><li><a href="#%E4%BD%9C%E6%A5%AD%E3%81%AB%E3%82%88%E3%82%8B%E5%BD%B1%E9%9F%BF-1">作業による影響</a></li><li><a href="#%E4%BD%9C%E6%A5%AD%E5%AF%BE%E8%B1%A1-1">作業対象</a></li><li><a href="#%E4%BD%9C%E6%A5%AD%E6%89%8B%E9%A0%86-1">作業手順</a></li></ul></li><li><a href="#%E6%A7%8B%E6%88%90%E3%82%AD%E3%83%A3%E3%83%83%E3%82%B7%E3%83%A5%E3%81%AE%E4%B8%8D%E6%95%B4%E5%90%88%E3%81%8C%E7%99%BA%E7%94%9F%E3%81%99%E3%82%8B%E8%A6%81%E5%9B%A0">構成キャッシュの不整合が発生する要因</a></li></ul><hr><h2 id="手動による構成キャッシュの再作成手順"><a href="#手動による構成キャッシュの再作成手順" class="headerlink" title="手動による構成キャッシュの再作成手順"></a>手動による構成キャッシュの再作成手順</h2><p>ここでは、手動による構成キャッシュの再作成手順をご案内いたします。</p><h3 id="作業による影響"><a href="#作業による影響" class="headerlink" title="作業による影響"></a>作業による影響</h3><p>SharePoint Server 2016 においては、キャッシュのクリアを実施中にユーザーアクセスが発生した際に、サイトアクセスに失敗するといった事例を確認しております。<br>SharePoint Server 2016 以外の SharePoint Server 製品では同様の事例は確認されておりませんが、構成キャッシュの削除によってページが正常に表示されない事象が発生した場合に備え、構成キャッシュの再作成の手順を実施後に IISRESET コマンドによる IIS の再起動を実施いただくことを推奨しております。<br>IISREST コマンドの実施中は、ユーザーがサイトにアクセス出来なくなるため、ユーザーのご利用の少ない時間帯や営業時間外にご実施ください。<br>また、タイマーサービスの停止中には、一時的にタイマー ジョブが実行されません。このため、作業時間帯にクロールの開始などがスケジュールされていた場合、これらのスケジュールは実行されませんのでご注意ください。<br>ただし、これらは一時的な影響であり、次回のスケジュール時にサービスが再開されていれば問題ございません。</p><h3 id="作業対象"><a href="#作業対象" class="headerlink" title="作業対象"></a>作業対象</h3><p>ローカルの管理者権限を持つアカウントで作業対象の SharePoint サーバーにログオンを行い、<a href="#%E4%BD%9C%E6%A5%AD%E6%89%8B%E9%A0%86">作業手順</a> に記載されている手順を SharePoint サーバーごとに (1 台ずつ) 実施します。</p><h3 id="作業手順"><a href="#作業手順" class="headerlink" title="作業手順"></a>作業手順</h3><ol><li><p>SharePoint サーバー上で動作している SharePoint Timer Service を停止します。</p><ul><li>1-1) [管理ツール] から [サービス] を起動します。</li><li>1-2) サービスの一覧から、”SharePoint Timer Service” を右クリックして、さらに [停止] をクリックします。<br><img src="/blog/sharepoint-server/clear-configcache/01_stop-timer-service.png" alt="SharePoint Timer Service の停止"></li></ul></li><li><p>SharePoint サーバーのローカルのファイル システムに保存されている構成キャッシュ ファイルを削除します。</p><ul><li><p>2-1) レジストリ エディターを起動します。</p></li><li><p>2-2) 下記のレジストリの値 (GUID) を確認します。</p><p>  ※本手順で確認したレジストリの値は、同じファーム内の別の SharePoint サーバーでも同一の値となりますため、これ以降の SharePoint サーバーではレジストリの値を確認する必要はございません。 </p><ul><li>SharePoint Server 2013 の場合: <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Shared Tools\Web ServerExtensions\15.0\Secure\ConfigDB\Id</code></li><li>SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition の場合: <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Shared Tools\Web ServerExtensions\16.0\Secure\ConfigDB\Id</code></li></ul><p>  <img src="/blog/sharepoint-server/clear-configcache/02_regedit.png" alt="構成データベースの ID を確認 (regedit)"></p></li><li><p>2-3) エクスプローラー上で、下記のパスに移動します。下記の画面ショットの通り、XML ファイルが大量に存在するフォルダとなります。</p><p>  <code>%ALLUSERSPROFILE%\Microsoft\SharePoint\Config\&lt;上記手順 2-2 で確認したレジストリの値&gt;</code></p><p>  例) <code>C:\ProgramData\Microsoft\SharePoint\Config\0ae0b94c-5232-4ba9-add3-2b61d7deb90</code><br>  <img src="/blog/sharepoint-server/clear-configcache/03_config_cache_folder.png" alt="構成キャッシュのフォルダ"></p></li><li><p>2-3) 上記のフォルダ内の XML ファイルを全て削除します。なお、この際に、同フォルダ内に存在する cache.ini ファイルを誤って削除しないように注意します。</p></li><li><p>2-4) XML ファイルの削除後、cache.ini ファイルをメモ帳で開きます。</p></li><li><p>2-5) cache.ini ファイル内の 1 行目の数値を 1 に変更し、上書き保存をしてファイルを閉じます。<br>  <img src="/blog/sharepoint-server/clear-configcache/04_cache_ini_before.png" alt="cache.ini の編集前"><br>  <img src="/blog/sharepoint-server/clear-configcache/05_cache_ini_after.png" alt="cache.ini の編集後"></p></li></ul></li><li><p>停止した SharePoint Timer Service を再開します。</p><ul><li>3-1) [管理ツール] から [サービス] を起動します。</li><li>3-2 サービスの一覧から、”SharePoint Timer Service” を右クリックして、さらに [開始] をクリックします。<br>  <img src="/blog/sharepoint-server/clear-configcache/06_start-timer-service.png" alt="SharePoint Timer Service の再開"></li></ul></li><li><p>ご利用の SharePoint Server 製品が SharePoint Server 2016 の場合、IIS の再起動を行います。</p><ul><li><p>4-1) コマンド プロンプトを管理者権限で起動します。</p></li><li><p>4-2) <code>iisreset /noforce</code> コマンドを実行し、IIS の再起動を行います。</p><p>  <em>※IIS の再起動が完了するまで、一時的にユーザーがサイトにアクセス出来なくなるため、ご注意ください。</em></p></li></ul></li><li><p>動作確認を行います。</p><ul><li><p>5-1) 手順 2.3 で移動した構成キャッシュのフォルダ上に、再度 XML ファイルが再作成されていることを確認します。</p></li><li><p>5-2) cache.ini ファイルを開き、1 以外の数値となっていることを確認します。</p><p>  ※SharePoint Timer Service の再起動後、数分間は cache.ini がロックされた状態になります。その場合は少し時間を空けてから再度ご確認ください。</p></li></ul></li></ol><hr><h2 id="スクリプトを使用した構成キャッシュの再作成手順"><a href="#スクリプトを使用した構成キャッシュの再作成手順" class="headerlink" title="スクリプトを使用した構成キャッシュの再作成手順"></a>スクリプトを使用した構成キャッシュの再作成手順</h2><p>ここでは、<a href="#%E6%89%8B%E5%8B%95%E3%81%AB%E3%82%88%E3%82%8B%E6%A7%8B%E6%88%90%E3%82%AD%E3%83%A3%E3%83%83%E3%82%B7%E3%83%A5%E3%81%AE%E5%86%8D%E4%BD%9C%E6%88%90%E6%89%8B%E9%A0%86">手動による構成キャッシュの再作成手順</a> と同等の手順を実施するための PowerShell スクリプトをご案内いたします。<br>なお、本スクリプトでは、<a href="#%E6%89%8B%E5%8B%95%E3%81%AB%E3%82%88%E3%82%8B%E6%A7%8B%E6%88%90%E3%82%AD%E3%83%A3%E3%83%83%E3%82%B7%E3%83%A5%E3%81%AE%E5%86%8D%E4%BD%9C%E6%88%90%E6%89%8B%E9%A0%86">手動による構成キャッシュの再作成手順</a> における IISRESET コマンド (手順 4-2) の処理は含まれておりませんため、管理者様にて別途ご実施いただく必要がございます。</p><h3 id="作業による影響-1"><a href="#作業による影響-1" class="headerlink" title="作業による影響"></a>作業による影響</h3><p><a href="#%E6%89%8B%E5%8B%95%E3%81%AB%E3%82%88%E3%82%8B%E6%A7%8B%E6%88%90%E3%82%AD%E3%83%A3%E3%83%83%E3%82%B7%E3%83%A5%E3%81%AE%E5%86%8D%E4%BD%9C%E6%88%90%E6%89%8B%E9%A0%86">手動による構成キャッシュの再作成手順</a> をご参考ください。</p><h3 id="作業対象-1"><a href="#作業対象-1" class="headerlink" title="作業対象"></a>作業対象</h3><p>ローカルの管理者権限を持ったファーム アカウントで作業対象の SharePoint サーバーにログオンを行い、<a href="#%E4%BD%9C%E6%A5%AD%E6%89%8B%E9%A0%86-1">作業手順</a> に記載されている手順を SharePoint サーバーごとに (1 台ずつ) 実施します。</p><h3 id="作業手順-1"><a href="#作業手順-1" class="headerlink" title="作業手順"></a>作業手順</h3><ol><li><p>スクリプトを GitHub から入手し、作業対象の SharePoint サーバーに配置します。</p><ul><li><p>1-1) 以下の URL にアクセスし、画面右上の [Code] - [Download Zip] でダウンロードした zip ファイルに含まれる Clear-SPConfigCache.ps1 を、作業対象の SharePoint サーバー上に展開します。</p><p>  <a href="https://github.com/jpspsupport/Clear-SPConfigCache">https://github.com/jpspsupport/Clear-SPConfigCache</a></p><p>  ※以降の手順では、SharePoint サーバー上のローカルの “C:\temp” に展開したことを想定します。(C:\temp\Clear-SPConfigCache.ps1)</p></li><li><p>1-2) [スタート] メニューから、[Microsoft SharePoint Products] 内の [SharePoint 管理シェル] を右クリックして [管理者として実行] をクリックします。(管理シェルの名称は、ご利用の製品バージョンに読み替えます。)</p></li><li><p>1-3) 下記のコマンドによってスクリプトを実行します。</p><blockquote><p>C:\temp\Clear-SPConfigCache.ps1</p></blockquote><p>  ※PowerShell のスクリプト実行ポリシーによっては、インターネットから入手したスクリプトの実行が制限されている可能性がございます。その場合、下記のコマンドによって、一時的にスクリプトの実行ポリシーを変更した状態でスクリプトを実行します。</p><blockquote><p>powershell -ExecutionPolicy Bypass -Command “C:\temp\Clear-SPConfigCache.ps1”</p></blockquote></li><li><p>1-4) スクリプトの実行時に、下記のようなメッセージが管理シェル上に出力され構成キャッシュが削除されます。</p><p>  ※SharePoint Server 2016 の場合、最後に IIS の再起動を促すメッセージ (Run ‘iisreset /noforce’ manually.) が表示されます。</p><blockquote><p> Stop SharPoint Timer Service.<br> Succeeded to stop SharPoint Timer Service.<br> Clear configuration cache files of ‘SharePoint_Config’ (&lt;GUID&gt;).<br> Delete 1807 XML files.<br> Deleted.<br> Modifiy cache.ini file.<br> Succeeded to modify cache.ini file.<br> Succeeded to clear configuration cache files of ‘SharePoint_Config’ (&lt;GUID&gt;).<br> Restart SharPoint Timer Service.<br> Succeeded to restart SharPoint Timer Service.<br> Run ‘iisreset /noforce’ manually.</p></blockquote></li></ul></li><li><p>ご利用の SharePoint Server 製品が SharePoint Server 2016 の場合、IIS の再起動を行います。</p><ul><li><p>2-1) コマンド プロンプトを管理者権限で起動します。</p></li><li><p>2-2) <code>iisreset /noforce</code> コマンドを実行し、IIS の再起動を行います。</p><p>  <em>※IIS の再起動が完了するまで、一時的にユーザーがサイトにアクセス出来なくなるため、ご注意ください。</em></p></li></ul></li></ol><h2 id="構成キャッシュの不整合が発生する要因"><a href="#構成キャッシュの不整合が発生する要因" class="headerlink" title="構成キャッシュの不整合が発生する要因"></a>構成キャッシュの不整合が発生する要因</h2><p>構成キャッシュの不整合が発生する状況といたしましては、SharePoint のプロセスがキャッシュに書き込みを行うタイミングで、SharePoint 以外のプロセスがキャッシュ ファイル (またはフォルダ) をロックしているため、書き込みに失敗した状況が考えられます。<br>しかしながら、過去 (構成キャッシュの不整合が発生したタイミング) に遡ってログを取得することは不可能であり、構成キャッシュに不整合が発生する具体的な原因を、不整合が発生した後から特定できません。<br>構成キャッシュの不整合が発生する要因といたしましては、キャッシュのフォルダがウィルス対策ソフトの監視対象になっている場合、キャッシュ ファイルの更新などに失敗することが報告されております。<br>このため、以下の技術情報をご参考いただき、ご利用のウィルス対策ソフトで除外設定についてご確認ください。</p><p><a href="https://support.microsoft.com/en-us/office/certain-folders-may-have-to-be-excluded-from-antivirus-scanning-when-you-use-file-level-antivirus-software-in-sharepoint-01cbc532-a24e-4bba-8d67-0b1ed733a3d9?ui=en-us&rs=en-us&ad=us" title="Certain folders may have to be excluded from antivirus scanning when you use file-level antivirus software in SharePoint">Certain folders may have to be excluded from antivirus scanning when you use file-level antivirus software in SharePoint</a></p><p>※ SharePoint Server 2013 をご利用の場合は、SharePoint Foundation 2013 に記載のフォルダについても除外対象設定を実施ください。</p><hr>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;本投稿は、以前の &lt;a href=&quot;https://social.msdn.microsoft.com/Forums/ja-JP/590627a7-d369-47b2-bfc8-7726d7cf9342/2708325104124611251512</summary>
      
    
    
    
    
    <category term="SharePoint Server" scheme="https://jpspsupport.github.io/blog/tags/SharePoint-Server/"/>
    
  </entry>
  
  <entry>
    <title>SharePoint Online 管理シェルは SharePoint Online Client Components SDK がインストールされた端末で使用できません</title>
    <link href="https://jpspsupport.github.io/blog/sharepoint-online/managementshell-clientcomponentsSDK/"/>
    <id>https://jpspsupport.github.io/blog/sharepoint-online/managementshell-clientcomponentsSDK/</id>
    <published>2021-07-12T15:00:00.000Z</published>
    <updated>2022-06-20T04:12:12.495Z</updated>
    
    <content type="html"><![CDATA[<p>SharePoint Online 管理シェル (SharePoint Online Management Shell) と SharePoint Client Component SDK を同じ端末上にインストールした場合、SharePoint Online 管理シェルの起動時にモジュールの読み込みに失敗し、エラーが発生します。</p><p><img src="/blog/sharepoint-online/managementshell-clientcomponentsSDK/SPOManagementShell.png" alt="SharePoint Online 管理シェル起動時のエラー"></p><p>このエラーは、Windows PowerShell 上で “Microsoft.Online.SharePoint.PowerShell” モジュールを指定してインポートした場合にも同様に発生します。</p><p><img src="/blog/sharepoint-online/managementshell-clientcomponentsSDK/WindowsPowerShell.png" alt="Windows PowerShell のモジュール読み込み時のエラー"></p><p>&lt;エラー メッセージの抜粋&gt;</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Import-Module : Could not load type &#x27;Microsoft.SharePoint.Client.Publishing.PortalLaunch.PortalLaunchRedirectionType&#x27;</span><br><span class="line">from assembly &#x27;Microsoft.SharePoint.Client.Publishing, Version=16.0.0.0, Culture=neutral,</span><br><span class="line">PublicKeyToken=71e9bce111e9429c&#x27;.</span><br><span class="line">At line:1 char:1</span><br><span class="line">+ Import-Module Microsoft.Online.SharePoint.PowerShell -DisableNameChec ...</span><br><span class="line">+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span><br><span class="line">    + CategoryInfo          : NotSpecified: (:) [Import-Module], TypeLoadException</span><br><span class="line">    + FullyQualifiedErrorId : System.TypeLoadException,Microsoft.PowerShell.Commands.ImportModuleCommand</span><br></pre></td></tr></table></figure><p>エラーを回避して SharePoint Online 管理シェルを利用するには、SharePoint Online Client Components SDK をアンインストールする必要があります。<br>本内容は、以下の公開情報にも記載されております。</p><p>タイトル : SharePoint Online 管理シェルを使用して作業を開始する<br>アドレス : <a href="https://docs.microsoft.com/ja-jp/powershell/sharepoint/sharepoint-online/connect-sharepoint-online?view=sharepoint-ps">https://docs.microsoft.com/ja-jp/powershell/sharepoint/sharepoint-online/connect-sharepoint-online?view=sharepoint-ps</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SharePoint Online 管理シェル モジュールと SharePoint クライアント コンポーネント SDK の間には既知の問題があります。この SDK では、両方が同じコンピューターにインストールされている場合、モジュールの読み込みに失敗します。 この問題が発生した場合は、SharePoint クライアント コンポーネント SDK をアンインストールします。</span><br></pre></td></tr></table></figure><h2 id="SharePoint-Online-Client-Components-SDK-のアンインストール手順"><a href="#SharePoint-Online-Client-Components-SDK-のアンインストール手順" class="headerlink" title="SharePoint Online Client Components SDK のアンインストール手順"></a>SharePoint Online Client Components SDK のアンインストール手順</h2><ol><li>[コントロール パネル] で [プログラム] &gt; [プログラムのアンインストール] をクリックします。</li><li>“SharePoint Client Components” を右クリックして、[アンインストール] をクリックします。<br>※ これにより、SDK によってグローバル アセンブリ キャッシュ (GAC) に配置された CSOM アセンブリが削除されます。</li><li> SharePoint Online 管理シェルを再起動して、エラーが解消されることをご確認ください。</li></ol><p>端末上で SharePoint CSOM と SharePoint Online 管理シェルの両方を使用する必要がある場合は、SharePoint Online Client Components SDK でインストールされる CSOM パッケージを NuGet パッケージとしてウェブからダウンロードすることで、SharePoint Online 管理シェルと CSOM を同じ端末上で利用することが出来ます。</p><h2 id="CSOM-パッケージをダウンロードする"><a href="#CSOM-パッケージをダウンロードする" class="headerlink" title="CSOM パッケージをダウンロードする"></a>CSOM パッケージをダウンロードする</h2><ol><li>インターネットに接続可能な端末で、下記サイトから Microsoft.SharePointOnline.CSOM パッケージをダウンロードします。</li></ol><p>タイトル : Microsoft.SharePointOnline.CSOM<br>アドレス : <a href="https://www.nuget.org/packages/Microsoft.SharePointOnline.CSOM">https://www.nuget.org/packages/Microsoft.SharePointOnline.CSOM</a></p><ol start="2"><li>.nupkg ファイルの拡張子を .zip に変更します。</li><li>.zip ファイルを展開します。</li><li>lib\net45 フォルダー内の DLL を任意の場所にコピーします。(C:\CSOM\lib\net45\ 等)</li><li>ご利用のアプリケーションで CSOM アセンブリを読み込めることをご確認ください。<br>※パスを指定してアセンブリを読み込んでいた場合は、必要に応じてパスを変更ください。</li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;SharePoint Online 管理シェル (SharePoint Online Management Shell) と SharePoint Client Component SDK を同じ端末上にインストールした場合、SharePoint Online 管理シェルの</summary>
      
    
    
    
    
    <category term="SharePoint Online" scheme="https://jpspsupport.github.io/blog/tags/SharePoint-Online/"/>
    
  </entry>
  
  <entry>
    <title>TLS 1.0 や 1.1 廃止による TokenHelper アプリ専用トークン取得動作への影響について</title>
    <link href="https://jpspsupport.github.io/blog/sharepoint-online/impact-of-tokenhelper-from-disabling-tls1.0/"/>
    <id>https://jpspsupport.github.io/blog/sharepoint-online/impact-of-tokenhelper-from-disabling-tls1.0/</id>
    <published>2021-03-24T15:00:00.000Z</published>
    <updated>2022-06-20T04:12:12.491Z</updated>
    
    <content type="html"><![CDATA[<p>Microsoft 365 においては、メッセージ センターや各公開情報に記載の通り、TLS 1.0 と 1.1 を廃止し、新しい暗号化技術を基準とすることで、お客様データのセキュリティ保護を向上する動きを拡大しております。<br>全世界のお客様を想定すると一部に限定されることを想定してはおりますが、特に旧バージョンのオペレーティング システムや .NET Framework (4.5 以下) 基盤をご利用の場合は、ご自身のシステムが影響を受けないか今一度ご確認ください。</p><p>一般的な HTTPS 通信においては、トランスポート層において TLS プロトコルはクライアントとサーバーで対応バージョン等の情報を交換し、ハンドシェイクを実施します。該当処理の確立後は、当該暗号化技術の上で上位層 (アプリケーション層を含む) の通信を開始していく流れです。<br>TLS 1.0 や 1.1 が廃止が適応されると、クライアントから TLS 1.0 を要求した際に、Microsoft 365 の各種サーバーがこれを拒否し、トランスポート層で通信が遮断される動作となります。</p><p>このような遮断を受けた時、.NET アプリケーション側で確認する典型的なエラーは以下となります。</p><h3 id="典型的な例外の例"><a href="#典型的な例外の例" class="headerlink" title="典型的な例外の例"></a>典型的な例外の例</h3><p><code>System.Net.WebException: The underlying connection was closed: An unexpected error occurred on a send. --&gt; System.IO.IOException: Unable to read data from the transport connection: An existing connection was forcibly closed by the remote host. --&gt; System.Net.Sockets.SocketException: An existing connection was forcibly closed by the remote host.</code></p><p>HttpWebRequest.GetResponse メソッドや、Client Side Object Model (CSOM) などでは、上記のようなエラーで、通信が遮断される動作が想定されます。<br>なお、TokenHelper などでアプリ専用トークンをご利用の場合は、少し異なったエラーが発生します。</p><h3 id="TokenHelper-アプリ専用トークン取得時の例"><a href="#TokenHelper-アプリ専用トークン取得時の例" class="headerlink" title="TokenHelper アプリ専用トークン取得時の例"></a>TokenHelper アプリ専用トークン取得時の例</h3><p><code>Microsoft.IdentityModel.SecurityTokenService.RequestFailedException: Token request failed. ---&gt; System.Net.WebException: The remote server returned an error: (401) Unauthorized.at System.Net.HttpWebRequest.GetResponse() at Microsoft.IdentityModel.S2S.Protocols.OAuth2.OAuth2WebRequest.GetResponse() at Microsoft.IdentityModel.S2S.Protocols.OAuth2.OAuth2S2SClient.Issue(String securityTokenServiceUrl OAuth2AccessTokenRequest oauth2Request) --- End of inner exception stack trace --- at Microsoft.IdentityModel.S2S.Protocols.OAuth2.OAuth2S2SClient.Issue(String securityTokenServiceUrl OAuth2AccessTokenRequest oauth2Request) at SampleNameSpace.TokenHelper.GetAppOnlyAccessToken(String targetPrincipalName String targetHost String targetRealm)</code></p><p>上記エラーが発生したとしても、対処方法としては TLS 1.2 を有効化する対応を実施ください。</p><h3 id="対処策"><a href="#対処策" class="headerlink" title="対処策"></a>対処策</h3><p>公開情報ご確認の上、上記のようなエラーが発生した場合は TLS 1.0 および 1.1 無効化による影響を疑い、対処を実施ください。</p><p>タイトル : TLS 1.2 を有効にする方法<br>アドレス : <a href="https://docs.microsoft.com/ja-jp/mem/configmgr/core/plan-design/security/enable-tls-1-2">https://docs.microsoft.com/ja-jp/mem/configmgr/core/plan-design/security/enable-tls-1-2</a></p><p>なお、Azure App Service 上のアプリで .NET Framework 4.5 以下をご使用の場合は、対象のフレームワークバージョンを 4.6 以上に上げることが推奨です。<br>ただし、参照アセンブリ等、依存関係の理由により難しい場合は、以下のコードを一行だけアプリケーションのなるべく早い段階の処理として加えることをお勧めします。<br>下記更新対象の値は static プロパティとしてアプリケーション全体をスコープとして影響し、アウトバウンドの TLS バージョンを 1.2 に指定します。 </p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ServicePointManager.SecurityProtocol = SecurityProtocolType.Tls12;</span><br></pre></td></tr></table></figure><h3 id="詳細説明"><a href="#詳細説明" class="headerlink" title="詳細説明"></a>詳細説明</h3><p>TokenHelper では、Realm を取得し、ClientID, ClientSecret および Realm を使用して、アクセストークンを取得する流れとなります。</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Get the realm for the URL</span></span><br><span class="line"><span class="built_in">string</span> realm = TokenHelper.GetRealmFromTargetUrl(<span class="keyword">new</span> Uri(siteUrl));</span><br><span class="line"></span><br><span class="line"><span class="comment">//Get the access token for the URL.  </span></span><br><span class="line"><span class="built_in">string</span> accessToken = TokenHelper.GetAppOnlyAccessToken(TokenHelper.SharePointPrincipal, <span class="keyword">new</span> Uri(siteUrl).Authority, realm).AccessToken;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Create a client context object based on the retrieved access token</span></span><br><span class="line"><span class="keyword">using</span> (ClientContext cc = TokenHelper.GetClientContextWithAccessToken(siteUrl, accessToken))</span><br><span class="line">&#123;</span><br><span class="line">    cc.Load(cc.Web, p =&gt; p.Title);</span><br><span class="line">    cc.ExecuteQuery();</span><br><span class="line">    Console.WriteLine(cc.Web.Title);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>エラーが発生する流れとして、まずは TLS によりトランスポート層で拒否されることにより、TokenHelper.GetReamFromTargetUrl メソッド内で上記典型的な例外 : WebException (内部例外は IOException と SocketException) が返されます。<br>しかし、GetRealmFromTargetUrl メソッドは WebException をメソッド外部にスローしない実装です。該当リクエストは HTTP 応答 401 が返ることを想定したコードであるため、内部で例外を補足し、HTTP 応答ヘッダー WWW-Authenticate の値から Realm の情報を読み取ろうとします。</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">GetRealmFromTargetUrl</span>(<span class="params">Uri targetApplicationUri</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">WebRequest request = WebRequest.Create(targetApplicationUri + <span class="string">&quot;/_vti_bin/client.svc&quot;</span>);</span><br><span class="line">request.Headers.Add(<span class="string">&quot;Authorization: Bearer &quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">using</span> (request.GetResponse())</span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">catch (WebException e)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (e.Response == <span class="literal">null</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> bearerResponseHeader = e.Response.Headers[<span class="string">&quot;WWW-Authenticate&quot;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">string</span>.IsNullOrEmpty(bearerResponseHeader))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="built_in">string</span> bearer = <span class="string">&quot;Bearer realm=\&quot;&quot;</span>;</span><br><span class="line"><span class="built_in">int</span> bearerIndex = bearerResponseHeader.IndexOf(bearer, StringComparison.Ordinal);</span><br><span class="line"><span class="keyword">if</span> (bearerIndex &lt; <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> realmIndex = bearerIndex + bearer.Length;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (bearerResponseHeader.Length &gt;= realmIndex + <span class="number">36</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">string</span> targetRealm = bearerResponseHeader.Substring(realmIndex, <span class="number">36</span>);</span><br><span class="line"></span><br><span class="line">Guid realmGuid;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (Guid.TryParse(targetRealm, <span class="keyword">out</span> realmGuid))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> targetRealm;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>しかし、トランスポート層で通信が拒否されます。アプリケーション層での通信は実行されないため、SharePoint Online サーバーから HTTP 応答ヘッダー WWW-Authenticate などの値は返されません。このことにより例外オブジェクトの HTTP ヘッダーから Realm が取得できず、Realm が null として返されます。</p><p>その結果、次の GetAppOnlyAccessToken メソッドに targetRealm が null が渡されます。<br>ACS に渡されるクライアント ID は、ClientID@Realm の形式で渡されます。この値が不正な形式 (ClientID@) となるため、HTTP 応答コード 401 と共に RequestFailedException が返されます。</p><p>もちろん、RequestFailedException 単体を見た場合、アプリケーションへの変更により、Client ID が使用できなくなった場合や、Client Secret の有効期限が切れた等の別事象も切り分ける必要はあります。<br>その際には、最新の Windows 端末等より、Connect-PnPOnline コマンドを実行して、アプリ定義自体に問題がないことを切り分けるのも有効な手段です。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Connect-PnPOnline</span> https://&#123;tenant&#125;.sharepoint.com <span class="literal">-ClientId</span> &lt;クライアント ID&gt; <span class="literal">-ClientSecret</span> &lt;クライアント シークレット&gt;</span><br></pre></td></tr></table></figure><h2 id="参考情報"><a href="#参考情報" class="headerlink" title="参考情報"></a>参考情報</h2><p>タイトル : Microsoft 365 の TLS 1.0 と 1.1 を無効にする<br>アドレス : <a href="https://docs.microsoft.com/ja-jp/microsoft-365/compliance/tls-1.0-and-1.1-deprecation-for-office-365?view=o365-worldwide">https://docs.microsoft.com/ja-jp/microsoft-365/compliance/tls-1.0-and-1.1-deprecation-for-office-365?view=o365-worldwide</a></p><p>タイトル : Office 365 および Office 365 GCC での TLS 1.2 の準備<br>アドレス : <a href="https://docs.microsoft.com/ja-jp/microsoft-365/compliance/prepare-tls-1.2-in-office-365?view=o365-worldwide">https://docs.microsoft.com/ja-jp/microsoft-365/compliance/prepare-tls-1.2-in-office-365?view=o365-worldwide</a></p><p>今回の投稿は以上です。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Microsoft 365 においては、メッセージ センターや各公開情報に記載の通り、TLS 1.0 と 1.1 を廃止し、新しい暗号化技術を基準とすることで、お客様データのセキュリティ保護を向上する動きを拡大しております。&lt;br&gt;全世界のお客様を想定すると一部に限定される</summary>
      
    
    
    
    
    <category term="SharePoint Online" scheme="https://jpspsupport.github.io/blog/tags/SharePoint-Online/"/>
    
  </entry>
  
  <entry>
    <title>Power Automate で SharePoint リスト アイテムに対して個別のアクセス権を付与する方法</title>
    <link href="https://jpspsupport.github.io/blog/sharepoint-online/power-automate-assign-permission/"/>
    <id>https://jpspsupport.github.io/blog/sharepoint-online/power-automate-assign-permission/</id>
    <published>2020-07-13T15:00:00.000Z</published>
    <updated>2022-06-20T04:12:12.495Z</updated>
    
    <content type="html"><![CDATA[<p>今回の投稿では、SharePoint Online における <a href="https://support.microsoft.com/ja-jp/office/1ca3fff8-9985-410a-85aa-8120f626965f?ui=ja-jp&rs=ja-jp&ad=jp">SharePoint 2010 形式ワークフローの廃止</a> (MC217999) に際して、移行先となる Power Automate を簡単に紹介します。</p><p>移行プロジェクトにおいて、最も技術的な懸案事項に指定されているものに、個別アクセス権の付与が数多く上げられております。アイテムごとにアクセス権を付与する運用は、パフォーマンスを考慮した場合は得策ではありません。しかしながら、多くのユーザーが SharePoint 2010 形式ワークフローを利用する一つの根強い理由として挙げられているため、ここに Power Automate による回避策を記載します。</p><p>なお、前提として <a href="https://docs.microsoft.com/ja-jp/office365/servicedescriptions/sharepoint-online-service-description/sharepoint-online-limits">SharePoint の制限</a> には、リストまたはライブラリ内のアイテムに対する固有の権限は 5,000 までと指定されております。そのため、固有のアクセス権を割り当てる運用を実施する場合、リストまたはライブラリ内のアイテムが 5,000 を超えないようキャパシティ プランをお願いします。</p><h2 id="公開情報より"><a href="#公開情報より" class="headerlink" title="公開情報より"></a>公開情報より</h2><p>公開情報には、アイテムまたはフォルダーへのアクセスを許可する、中止するといったアクションに対して、条件付きで可能との記載があります。</p><p>タイトル : Guidance: Migrate from classic workflows to Power Automate flows in SharePoint<br>アドレス : <a href="https://docs.microsoft.com/en-us/sharepoint/dev/business-apps/power-automate/guidance/migrate-from-classic-workflows-to-power-automate-flows">https://docs.microsoft.com/en-us/sharepoint/dev/business-apps/power-automate/guidance/migrate-from-classic-workflows-to-power-automate-flows</a></p><p><img src="/blog/sharepoint-online/power-automate-assign-permission/PAPERM00.png" alt="PublicArticle"></p><p>モダン UI のアクセス許可もクラシックのアクセス許可に影響するので、特に大きな問題はありません。以下のように落ち着いてソリューションを実施しましょう。</p><h2 id="ウォークスルー"><a href="#ウォークスルー" class="headerlink" title="ウォークスルー"></a>ウォークスルー</h2><h3 id="1-まずは、モダン-UI-のリストやライブラリから、-自動化-–-Power-Automate-–-フローの作成-よりフローを作成していきます。"><a href="#1-まずは、モダン-UI-のリストやライブラリから、-自動化-–-Power-Automate-–-フローの作成-よりフローを作成していきます。" class="headerlink" title="1. まずは、モダン UI のリストやライブラリから、[自動化] – [Power Automate] – [フローの作成] よりフローを作成していきます。"></a>1. まずは、モダン UI のリストやライブラリから、[自動化] – [Power Automate] – [フローの作成] よりフローを作成していきます。</h3><p><img src="/blog/sharepoint-online/power-automate-assign-permission/PAPERM01.png" alt="HowToStartPA"></p><h3 id="2-フローの作成ペインにて、-詳細の表示-–-既存の-SharePoint-リスト項目が修正されたときに、カスタム-アクションを完了する-をクリックします。"><a href="#2-フローの作成ペインにて、-詳細の表示-–-既存の-SharePoint-リスト項目が修正されたときに、カスタム-アクションを完了する-をクリックします。" class="headerlink" title="2. フローの作成ペインにて、[詳細の表示] – [既存の SharePoint リスト項目が修正されたときに、カスタム アクションを完了する] をクリックします。"></a>2. フローの作成ペインにて、[詳細の表示] – [既存の SharePoint リスト項目が修正されたときに、カスタム アクションを完了する] をクリックします。</h3><p><img src="/blog/sharepoint-online/power-automate-assign-permission/PAPERM02.png" alt="HowToStartPA2"></p><p><img src="/blog/sharepoint-online/power-automate-assign-permission/PAPERM03.png" alt="HowToStartPA2"></p><h3 id="3-続行-をクリックします。"><a href="#3-続行-をクリックします。" class="headerlink" title="3. [続行] をクリックします。"></a>3. [続行] をクリックします。</h3><p>画像ではマスクしていますが、ここに表示されるユーザーの権限で処理が実行されます。<br>サイト コレクションの管理者権限等、十分なアクセス権をフローの作成者に与えてください。</p><p><img src="/blog/sharepoint-online/power-automate-assign-permission/PAPERM04.png" alt="HowToStartPA3"></p><h3 id="4-フローの編集画面に遷移しました。-新しいステップ-をクリックして後続の処理を追加していきます。"><a href="#4-フローの編集画面に遷移しました。-新しいステップ-をクリックして後続の処理を追加していきます。" class="headerlink" title="4. フローの編集画面に遷移しました。[+ 新しいステップ] をクリックして後続の処理を追加していきます。"></a>4. フローの編集画面に遷移しました。[+ 新しいステップ] をクリックして後続の処理を追加していきます。</h3><p><img src="/blog/sharepoint-online/power-automate-assign-permission/PAPERM05.png" alt="HowToStartPA4"></p><h3 id="5-親のアクセス権を継承しない場合は、-アイテムまたはファイルの共有を停止します-を選択します。"><a href="#5-親のアクセス権を継承しない場合は、-アイテムまたはファイルの共有を停止します-を選択します。" class="headerlink" title="5. 親のアクセス権を継承しない場合は、[アイテムまたはファイルの共有を停止します] を選択します。"></a>5. 親のアクセス権を継承しない場合は、[アイテムまたはファイルの共有を停止します] を選択します。</h3><p><img src="/blog/sharepoint-online/power-automate-assign-permission/PAPERM06.png" alt="BreakRoleInheritance1"></p><h3 id="6-“リストまたはライブラリ”-と-“ID”-に動的なコンテンツ-値-を設定します。"><a href="#6-“リストまたはライブラリ”-と-“ID”-に動的なコンテンツ-値-を設定します。" class="headerlink" title="6. “リストまたはライブラリ” と “ID” に動的なコンテンツ (値) を設定します。"></a>6. “リストまたはライブラリ” と “ID” に動的なコンテンツ (値) を設定します。</h3><p><img src="/blog/sharepoint-online/power-automate-assign-permission/PAPERM07.png" alt="BreakRoleInheritance2"></p><h3 id="7-実際にアクセス権を適用していきます。アクション選択画面で-アイテムまたはフォルダーへのアクセス権の付与-をクリックします。"><a href="#7-実際にアクセス権を適用していきます。アクション選択画面で-アイテムまたはフォルダーへのアクセス権の付与-をクリックします。" class="headerlink" title="7. 実際にアクセス権を適用していきます。アクション選択画面で [アイテムまたはフォルダーへのアクセス権の付与] をクリックします。"></a>7. 実際にアクセス権を適用していきます。アクション選択画面で [アイテムまたはフォルダーへのアクセス権の付与] をクリックします。</h3><p><img src="/blog/sharepoint-online/power-automate-assign-permission/PAPERM08.png" alt="RoleAssignmentsAdd1"></p><h3 id="8-受信者にはアクセス権を与えるユーザーを指定し、ロールには権限レベルを指定します。"><a href="#8-受信者にはアクセス権を与えるユーザーを指定し、ロールには権限レベルを指定します。" class="headerlink" title="8. 受信者にはアクセス権を与えるユーザーを指定し、ロールには権限レベルを指定します。"></a>8. 受信者にはアクセス権を与えるユーザーを指定し、ロールには権限レベルを指定します。</h3><p>この例では、リストに追加されたユーザー列である、”共同編集者” を動的なコンテンツ (値) から指定しています。<br>ロールとしては、Can edit と Can view のいずれかをプルダウンから選択します。</p><p><img src="/blog/sharepoint-online/power-automate-assign-permission/PAPERM09.png" alt="RoleAssignmentsAdd2"></p><p>これで、最低限アクセス許可を与えるフローの作成は完成です。</p><h2 id="編集や閲覧以外のアクセス許可を付与する方法"><a href="#編集や閲覧以外のアクセス許可を付与する方法" class="headerlink" title="編集や閲覧以外のアクセス許可を付与する方法"></a>編集や閲覧以外のアクセス許可を付与する方法</h2><p>アクション側の入力項目において、ロールには Can edit と Can View が 2 択で表示されますが、[カスタム値の入力] をクリックして、他のアクセス権 (ロール) を付与することは可能であることを確認しています。</p><p><img src="/blog/sharepoint-online/power-automate-assign-permission/PAPERM10.png" alt="OtherRoleDefs1"></p><p>この部分のみ、少し複雑な手順となりますが、併せて以下に記載します。</p><h3 id="1-必要とするロール定義の-ID-を取得します。"><a href="#1-必要とするロール定義の-ID-を取得します。" class="headerlink" title="1. 必要とするロール定義の ID を取得します。"></a>1. 必要とするロール定義の ID を取得します。</h3><p>以下の a か b のいずれかの方法をご利用ください。</p><h4 id="a-PowerShell-を使用する場合"><a href="#a-PowerShell-を使用する場合" class="headerlink" title="a. PowerShell を使用する場合"></a>a. PowerShell を使用する場合</h4><p>a-1. PnP PowerShell をお持ちでない場合は<a href="https://docs.microsoft.com/ja-jp/powershell/sharepoint/sharepoint-pnp/sharepoint-pnp-cmdlets?view=sharepoint-ps">入手</a>します。<br>a-2. Connect-PnPOnline &lt;サイト URL&gt; を実行します。<br>a-3. Get-PnPRoleDefinition を実行して、サイトに存在するロールの定義を一覧表示します。<br>a-4. Get-PnPRoleDefinition -Identity &lt;ロール名&gt; | select Id を実行して Id を抜き出します。</p><p>以下の例では、フルコントロールの Id として 1073741829 を取得します。</p><p><img src="/blog/sharepoint-online/power-automate-assign-permission/PAPERM11.png" alt="OtherRoleDefs2"></p><h4 id="b-REST-を使用する場合"><a href="#b-REST-を使用する場合" class="headerlink" title="b. REST を使用する場合"></a>b. REST を使用する場合</h4><p>b-1. ブラウザーで SharePoint のページを表示します。<br>b-2. サイト URL 配下を以下のように変更します。<br><a href="https://tenant.sharepoint.com/sites/site/_api/web/roledefinitions">https://tenant.sharepoint.com/sites/site/_api/web/roledefinitions</a><br>b-3. XML でロール名が表示されるので、ロール名に対応する Id を取得します。</p><p>以下の例では “フル コントロール” の ID として 1073741829 を取得します。</p><p><img src="/blog/sharepoint-online/power-automate-assign-permission/PAPERM12.png" alt="OtherRoleDefs3"></p><p>IE などのブラウザーでは、フィード画面が表示される場合があります。その場合、[Alt] キーを押し、[ファイル] - [名前を付けて保存] をクリックして結果をローカル ファイルに保存すると、ブラウザー側に返されている XML のデータが保存されます。</p><h3 id="2-“アイテムまたはフォルダーへのアクセス権の付与”-のアクションにて、role-ID-値-を文字列で指定します。"><a href="#2-“アイテムまたはフォルダーへのアクセス権の付与”-のアクションにて、role-ID-値-を文字列で指定します。" class="headerlink" title="2. “アイテムまたはフォルダーへのアクセス権の付与” のアクションにて、role:ID 値 を文字列で指定します。"></a>2. “アイテムまたはフォルダーへのアクセス権の付与” のアクションにて、role:ID 値 を文字列で指定します。</h3><p><img src="/blog/sharepoint-online/power-automate-assign-permission/PAPERM13.png" alt="OtherRoleDefs4"></p><h2 id="実行結果"><a href="#実行結果" class="headerlink" title="実行結果"></a>実行結果</h2><p>リストにアイテムを投稿すると、共同編集者列のユーザーにアクセス許可が付与される動作を確認できます。</p><p><img src="/blog/sharepoint-online/power-automate-assign-permission/PAPERM14.png" alt="TETSUOCANEDITNOW"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;今回の投稿では、SharePoint Online における &lt;a href=&quot;https://support.microsoft.com/ja-jp/office/1ca3fff8-9985-410a-85aa-8120f626965f?ui=ja-jp&amp;rs=ja-jp</summary>
      
    
    
    
    
    <category term="SharePoint Online" scheme="https://jpspsupport.github.io/blog/tags/SharePoint-Online/"/>
    
  </entry>
  
  <entry>
    <title>Power Automate で簡単な承認フローを作成する</title>
    <link href="https://jpspsupport.github.io/blog/sharepoint-online/introduction-to-power-automate/"/>
    <id>https://jpspsupport.github.io/blog/sharepoint-online/introduction-to-power-automate/</id>
    <published>2020-07-09T15:00:00.000Z</published>
    <updated>2022-06-20T04:12:12.491Z</updated>
    
    <content type="html"><![CDATA[<p>今回の投稿では、SharePoint Online における <a href="https://support.microsoft.com/ja-jp/office/1ca3fff8-9985-410a-85aa-8120f626965f?ui=ja-jp&rs=ja-jp&ad=jp">SharePoint 2010 形式ワークフローの廃止</a> (MC217999) に際して、移行先となる Power Automate を簡単に紹介します。</p><p>これまで移行先の Power Automate の採用を決定できない一つの要因に、Power Automate に慣れていないことが挙げられていることがあると思います。<br>Power Automate の承認ワークフローを作成する方法は、様々な方々がすでに画面付きで手順を公開しておりますので、新たに作成する方法はないかと当初は考えました。しかしながら、初学の場合においては資料との相性等もあるかと思いますので、少しでも参考資料の選択肢が多い方がいいと思います。</p><p>そこで、本投稿でも手順を紹介します。現行バージョンの Power Automate でのご説明になりますが高度なものは作成せず、シンプルな処理で構成し、細かな操作を説明し、スピーディにキャッチアップできる形を目指します。</p><h2 id="移行シナリオの参考情報"><a href="#移行シナリオの参考情報" class="headerlink" title="移行シナリオの参考情報"></a>移行シナリオの参考情報</h2><p>SharePoint 2010 形式ワークフローからの移行を検討している方には、マイクロソフトからの公開情報としては以下のサイトをご確認いただくことをお勧めします。</p><p>タイトル : Microsoft SharePoint Connector in Power 自動<br>アドレス : <a href="https://docs.microsoft.com/ja-jp/sharepoint/dev/business-apps/power-automate/sharepoint-connector-actions-triggers">https://docs.microsoft.com/ja-jp/sharepoint/dev/business-apps/power-automate/sharepoint-connector-actions-triggers</a></p><p>タイトル : Power 自動化を使用して SharePoint でドキュメントの承認を必須にする<br>アドレス : <a href="https://docs.microsoft.com/ja-jp/sharepoint/dev/business-apps/power-automate/guidance/require-doc-approval">https://docs.microsoft.com/ja-jp/sharepoint/dev/business-apps/power-automate/guidance/require-doc-approval</a></p><p>下記サイトには、SharePoint ワークフローと Power Automate の機能の対比表が含まれています。</p><p>タイトル : ガイダンス: SharePoint で従来のワークフローからパワー自動化フローに移行する<br>アドレス : <a href="https://docs.microsoft.com/ja-jp/sharepoint/dev/business-apps/power-automate/guidance/migrate-from-classic-workflows-to-power-automate-flows">https://docs.microsoft.com/ja-jp/sharepoint/dev/business-apps/power-automate/guidance/migrate-from-classic-workflows-to-power-automate-flows</a></p><h2 id="ウォークスルー"><a href="#ウォークスルー" class="headerlink" title="ウォークスルー"></a>ウォークスルー</h2><p>それでは、実際に Power Automate で処理を作成していき、操作に慣れることを目指しましょう。</p><h3 id="1-コマンド-バーより-自動化-–-Power-Automate-–-フローの作成-をクリックします。"><a href="#1-コマンド-バーより-自動化-–-Power-Automate-–-フローの作成-をクリックします。" class="headerlink" title="1. コマンド バーより [自動化] – [Power Automate] – [フローの作成] をクリックします。"></a>1. コマンド バーより [自動化] – [Power Automate] – [フローの作成] をクリックします。</h3><p>モダン UI で、リストやライブラリを表示すると、コマンドバーに [自動化] というメニューがあります。SharePoint は、ここからフローの作成を開始できます。</p><p><img src="/blog/sharepoint-online/introduction-to-power-automate/PA01.png" alt="PowerAutomate01"></p><h3 id="2-画面右に現れるフローの作成ペインにて-詳細の表示-を展開し、-新しいファイルが-SharePoint-に追加されたときに、カスタムアクションを完了する-をクリックしてフローの作成を開始します。"><a href="#2-画面右に現れるフローの作成ペインにて-詳細の表示-を展開し、-新しいファイルが-SharePoint-に追加されたときに、カスタムアクションを完了する-をクリックしてフローの作成を開始します。" class="headerlink" title="2. 画面右に現れるフローの作成ペインにて [詳細の表示] を展開し、[新しいファイルが SharePoint に追加されたときに、カスタムアクションを完了する] をクリックしてフローの作成を開始します。"></a>2. 画面右に現れるフローの作成ペインにて [詳細の表示] を展開し、[新しいファイルが SharePoint に追加されたときに、カスタムアクションを完了する] をクリックしてフローの作成を開始します。</h3><p>Power Automate では、シナリオに合わせてテンプレートを選択して、フローの作成を行うことができます。<br>そのため、SharePoint へのコネクターや、必要最小限の処理が含まれた状態で、フローを作成できるため生産的です。</p><p><img src="/blog/sharepoint-online/introduction-to-power-automate/PA02.png" alt="PowerAutomate02"><br><img src="/blog/sharepoint-online/introduction-to-power-automate/PA03.png" alt="PowerAutomate03"></p><h3 id="3-続行-をクリックします。"><a href="#3-続行-をクリックします。" class="headerlink" title="3. [続行] をクリックします。"></a>3. [続行] をクリックします。</h3><p><img src="/blog/sharepoint-online/introduction-to-power-automate/PA04.png" alt="PowerAutomate04"></p><h3 id="4-フローの編集画面に遷移しました。-新しいステップ-をクリックして後続の処理を追加していきます。"><a href="#4-フローの編集画面に遷移しました。-新しいステップ-をクリックして後続の処理を追加していきます。" class="headerlink" title="4. フローの編集画面に遷移しました。[+ 新しいステップ] をクリックして後続の処理を追加していきます。"></a>4. フローの編集画面に遷移しました。[+ 新しいステップ] をクリックして後続の処理を追加していきます。</h3><p>ライブラリにファイルがアップロードされて処理が開始するという部分ができあがった状態でスタートします。当初の設定値などは、色々と観察してみてください。</p><p><img src="/blog/sharepoint-online/introduction-to-power-automate/PA05.png" alt="PowerAutomate05"></p><h4 id="補足"><a href="#補足" class="headerlink" title="補足"></a>補足</h4><p>処理の最後ではなく、途中にアクションを差し込む場合は、アクション間にある線をポイントすると (+) マークが表れます。</p><p><img src="/blog/sharepoint-online/introduction-to-power-automate/PA06.png" alt="PowerAutomate06"></p><p>さらに [アクションの追加] を押すと、アクションが挿入できます。</p><p><img src="/blog/sharepoint-online/introduction-to-power-automate/PA07.png" alt="PowerAutomate07"></p><h3 id="5-アクション選択画面で-“承認”-を検索し、-開始して承認を待機-を選択します。"><a href="#5-アクション選択画面で-“承認”-を検索し、-開始して承認を待機-を選択します。" class="headerlink" title="5. アクション選択画面で “承認” を検索し、[開始して承認を待機] を選択します。"></a>5. アクション選択画面で “承認” を検索し、[開始して承認を待機] を選択します。</h3><p><img src="/blog/sharepoint-online/introduction-to-power-automate/PA08.png" alt="PowerAutomate08"></p><p>アクションについては、画面上側にサービス、下側にトリガーとアクションが表示されます。<br>検索機能はそれぞれに適用されます。ここでは “承認” を検索していますが、”承認” サービスだけではなく、承認というキーワードに該当するアクションを持つ各種サービスと、そのトリガーやアクションがすべて表示されています。<br>どのようなサービス、そしてそのトリガーやアクションが使用できるかは、公開情報を調べても結構ですし、ご自身で色々と検索しながら確認することもできます。</p><h3 id="6-“承認の種類”-にて、”カスタム応答-–-1-つの応答を待機”-をクリックします。"><a href="#6-“承認の種類”-にて、”カスタム応答-–-1-つの応答を待機”-をクリックします。" class="headerlink" title="6. “承認の種類” にて、”カスタム応答 – 1 つの応答を待機” をクリックします。"></a>6. “承認の種類” にて、”カスタム応答 – 1 つの応答を待機” をクリックします。</h3><p><img src="/blog/sharepoint-online/introduction-to-power-automate/PA09.png" alt="PowerAutomate09"></p><h3 id="7-“開始して承認を待機”-アクションの詳細を指定していきます。"><a href="#7-“開始して承認を待機”-アクションの詳細を指定していきます。" class="headerlink" title="7. “開始して承認を待機” アクションの詳細を指定していきます。"></a>7. “開始して承認を待機” アクションの詳細を指定していきます。</h3><p><img src="/blog/sharepoint-online/introduction-to-power-automate/PA10.png" alt="PowerAutomate10"></p><p>応答オプションには、承認者が選択する応答の選択肢 (例 承認、却下) を定義します。</p><p>各種エディターについてですが、アクションの各プロパティに直接文字入力をすると文字列の固定値が指定されます。<br>動的なコンテンツ (値) を扱いたい場合は、入力項目にフォーカスを当て、画面右下の吹き出しコンテンツから値を選択して使います。</p><h3 id="8-同じ要領で-新しいステップ-をクリックして-“条件”-アクションを追加します。"><a href="#8-同じ要領で-新しいステップ-をクリックして-“条件”-アクションを追加します。" class="headerlink" title="8. 同じ要領で [+ 新しいステップ] をクリックして “条件” アクションを追加します。"></a>8. 同じ要領で [+ 新しいステップ] をクリックして “条件” アクションを追加します。</h3><p><img src="/blog/sharepoint-online/introduction-to-power-automate/PA11.png" alt="PowerAutomate11"></p><h3 id="9-条件の左辺より順に、動的な値から-“応答”-“次の値に等しい”-文字列直接入力にて-“承認”-などと指定します。"><a href="#9-条件の左辺より順に、動的な値から-“応答”-“次の値に等しい”-文字列直接入力にて-“承認”-などと指定します。" class="headerlink" title="9. 条件の左辺より順に、動的な値から “応答”, “次の値に等しい”, 文字列直接入力にて “承認” などと指定します。"></a>9. 条件の左辺より順に、動的な値から “応答”, “次の値に等しい”, 文字列直接入力にて “承認” などと指定します。</h3><p><img src="/blog/sharepoint-online/introduction-to-power-automate/PA12.png" alt="PowerAutomate12"></p><p>1 つの応答を待機するモデルであれば、”結果” という値に、承認者が選択した値が入ってきます。<br>この値が “承認” ならば “はい” の方へ、そうでなければ “いいえ” の方に流すようにします。</p><h3 id="10-はい、いいえのそれぞれのブロックにて、-アクションの追加-をクリックし、”項目の更新”-アクションを挿入します。"><a href="#10-はい、いいえのそれぞれのブロックにて、-アクションの追加-をクリックし、”項目の更新”-アクションを挿入します。" class="headerlink" title="10. はい、いいえのそれぞれのブロックにて、[アクションの追加] をクリックし、”項目の更新” アクションを挿入します。"></a>10. はい、いいえのそれぞれのブロックにて、[アクションの追加] をクリックし、”項目の更新” アクションを挿入します。</h3><p><img src="/blog/sharepoint-online/introduction-to-power-automate/PA13.png" alt="PowerAutomate13"></p><h3 id="11-それぞれ、承認済みか却下という値を列に書き込むに今回のサンプルはとどめます。"><a href="#11-それぞれ、承認済みか却下という値を列に書き込むに今回のサンプルはとどめます。" class="headerlink" title="11. それぞれ、承認済みか却下という値を列に書き込むに今回のサンプルはとどめます。"></a>11. それぞれ、承認済みか却下という値を列に書き込むに今回のサンプルはとどめます。</h3><p><img src="/blog/sharepoint-online/introduction-to-power-automate/PA14.png" alt="PowerAutomate14"></p><h2 id="実行確認"><a href="#実行確認" class="headerlink" title="実行確認"></a>実行確認</h2><p>ユーザー エクスペリエンスを確認してみましょう。</p><p>ファイルをアップロードしてみてください。<br>しばらくすると承認者宛に以下のようなメールが届きます。</p><p><img src="/blog/sharepoint-online/introduction-to-power-automate/PA15.png" alt="PowerAutomate15"></p><p>そこで [承認] を選択して、[送信] をクリックすると、承認処理が完了です。</p><p><img src="/blog/sharepoint-online/introduction-to-power-automate/PA16.png" alt="PowerAutomate16"></p><p>Result 列に承認済みが記録されました。</p><p><img src="/blog/sharepoint-online/introduction-to-power-automate/PA17.png" alt="PowerAutomate17"></p><h2 id="その他、トラブルシューティング等"><a href="#その他、トラブルシューティング等" class="headerlink" title="その他、トラブルシューティング等"></a>その他、トラブルシューティング等</h2><p>エラーがある場合は、フローの編集画面から [左矢印] をクリックして、概要ページ内にある実行履歴をクリックします。<br>この画面内に失敗のエントリーがあれば、それをクリックしてトラブルシューティングすることができます。</p><p><img src="/blog/sharepoint-online/introduction-to-power-automate/PA18.png" alt="PowerAutomate18"></p><p>初めてのテクノロジーにおいても、スモール スタートで利用開始し、そこから少しずつテストしながら追加していくことで、ソリューションを作成できるものと考えております。<br>是非移行作業を進める上で、上記資料を準備にお役立てください。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;今回の投稿では、SharePoint Online における &lt;a href=&quot;https://support.microsoft.com/ja-jp/office/1ca3fff8-9985-410a-85aa-8120f626965f?ui=ja-jp&amp;rs=ja-jp</summary>
      
    
    
    
    
    <category term="SharePoint Online" scheme="https://jpspsupport.github.io/blog/tags/SharePoint-Online/"/>
    
  </entry>
  
  <entry>
    <title>SharePoint Modernization Scanner を使用して、移行対象のワークフローを抽出する</title>
    <link href="https://jpspsupport.github.io/blog/sharepoint-online/use-sp-modernization-scanner/"/>
    <id>https://jpspsupport.github.io/blog/sharepoint-online/use-sp-modernization-scanner/</id>
    <published>2020-07-08T15:00:00.000Z</published>
    <updated>2022-06-20T04:12:12.499Z</updated>
    
    <content type="html"><![CDATA[<p>今回の投稿では、SharePoint Online における <a href="https://support.microsoft.com/ja-jp/office/1ca3fff8-9985-410a-85aa-8120f626965f?ui=ja-jp&rs=ja-jp&ad=jp">SharePoint 2010 形式ワークフローの廃止</a> (MC217999) に際しての計画段階において、移行対象のワークフローを抽出する方法を詳細に記載します。</p><p>そのためのツールとして、SharePoint Modernization Scanner (SharePoint モダン化スキャナー) が公開されています。</p><p>最初に、移行する SharePoint 2010 形式ワークフローの全体像をつかむことは必須の作業となります。これをもとに、技術的な課題項目を整理したり、工数を見積もるという作業が派生してくると思います。<br>本投稿では、できる限りスムーズに移行検討作業に移れるよう、現バージョンの SharePoint モダン化スキャナーによる操作イメージを画面付きで紹介します。</p><h2 id="1-最初に下記サイトからツールをダウンロードします。"><a href="#1-最初に下記サイトからツールをダウンロードします。" class="headerlink" title="1. 最初に下記サイトからツールをダウンロードします。"></a>1. 最初に下記サイトからツールをダウンロードします。</h2><p>タイトル : SharePoint モダン化スキャナーを使い始める<br>アドレス : <a href="https://docs.microsoft.com/ja-jp/sharepoint/dev/transform/modernize-scanner">https://docs.microsoft.com/ja-jp/sharepoint/dev/transform/modernize-scanner</a></p><p><img src="/blog/sharepoint-online/use-sp-modernization-scanner/SMS01.png" alt="DownloadSMS"></p><h2 id="2-ダウンロードしたツールを実行します。"><a href="#2-ダウンロードしたツールを実行します。" class="headerlink" title="2. ダウンロードしたツールを実行します。"></a>2. ダウンロードしたツールを実行します。</h2><p><img src="/blog/sharepoint-online/use-sp-modernization-scanner/SMS02.png" alt="RunSMS"></p><h3 id="2-1-クライアント-ID-とクライアント-シークレットを用意します。"><a href="#2-1-クライアント-ID-とクライアント-シークレットを用意します。" class="headerlink" title="2-1. クライアント ID とクライアント シークレットを用意します。"></a>2-1. クライアント ID とクライアント シークレットを用意します。</h3><p>Selected Authentication Option ですが、テナント全体に対して実行する場合は、あらかじめテナント内の全サイト コレクションにアクセス可能なユーザーが用意できない場合は、アプリ専用トークンを利用することが現実的です。<br>アプリ専用トークンの種類は 2 種類あります。一般的にはライフサイクルを考慮した場合、継続的なアプリケーションの開発や利用を想定した場合は Azure AD App Only が推奨されますが、どちらでも現時点での機能面に変わりはないため、今回の一時的な利用においては操作が簡単な Azure ACS App Only のシナリオを進めていただくことで問題はありません。</p><p>別途以下のサイトなどの手順で Azure ACS クライアント ID と クライアント シークレットを入手します。</p><p>タイトル : PnP PowerShell でテナントのフルコントロール権限を使用して接続する方法について<br>アドレス : <a href="https://jpspsupport.github.io/blog/sharepoint-online/pnp-powershell-with-app-only-token/">https://jpspsupport.github.io/blog/sharepoint-online/pnp-powershell-with-app-only-token/</a></p><p>なお、上記サイトはテナントに対してフルコントロール権限でアプリを払い出しておりますので、適宜権限要求 XML を変更してサイトに対するフルコントロール等に変更していただいてもかまいません。</p><h3 id="2-2-クライアント-ID-とクライアント-シークレットを入力して-Next-をクリックします"><a href="#2-2-クライアント-ID-とクライアント-シークレットを入力して-Next-をクリックします" class="headerlink" title="2-2. クライアント ID とクライアント シークレットを入力して [Next] をクリックします"></a>2-2. クライアント ID とクライアント シークレットを入力して [Next] をクリックします</h3><h3 id="2-3-対象を指定して-Next-をクリックします。"><a href="#2-3-対象を指定して-Next-をクリックします。" class="headerlink" title="2-3. 対象を指定して [Next] をクリックします。"></a>2-3. 対象を指定して [Next] をクリックします。</h3><p><img src="/blog/sharepoint-online/use-sp-modernization-scanner/SMS03.png" alt="RunSMS2"></p><h2 id="3-Scan-mode-には-Classic-workflow-usage-を指定ください。"><a href="#3-Scan-mode-には-Classic-workflow-usage-を指定ください。" class="headerlink" title="3. Scan mode には Classic workflow usage を指定ください。"></a>3. Scan mode には Classic workflow usage を指定ください。</h2><p><img src="/blog/sharepoint-online/use-sp-modernization-scanner/SMS04.png" alt="RunSMS3"></p><h2 id="4-最後に細かな設定が可能ですが、-Start-Scan-を押すと開始します。"><a href="#4-最後に細かな設定が可能ですが、-Start-Scan-を押すと開始します。" class="headerlink" title="4.    最後に細かな設定が可能ですが、[Start Scan] を押すと開始します。"></a>4.    最後に細かな設定が可能ですが、[Start Scan] を押すと開始します。</h2><p><img src="/blog/sharepoint-online/use-sp-modernization-scanner/SMS04-2.png" alt="RunSMS3"></p><h2 id="5-実行時にはコマンド-プロンプトに進捗が書かれます。"><a href="#5-実行時にはコマンド-プロンプトに進捗が書かれます。" class="headerlink" title="5. 実行時にはコマンド プロンプトに進捗が書かれます。"></a>5. 実行時にはコマンド プロンプトに進捗が書かれます。</h2><p><img src="/blog/sharepoint-online/use-sp-modernization-scanner/SMS05.png" alt="RunSMS4"></p><h2 id="6-コマンド実行が完了すると、フォルダーが実行プログラム-EXE-と同一階層に現れます。"><a href="#6-コマンド実行が完了すると、フォルダーが実行プログラム-EXE-と同一階層に現れます。" class="headerlink" title="6. コマンド実行が完了すると、フォルダーが実行プログラム (*.EXE) と同一階層に現れます。"></a>6. コマンド実行が完了すると、フォルダーが実行プログラム (*.EXE) と同一階層に現れます。</h2><p><img src="/blog/sharepoint-online/use-sp-modernization-scanner/SMS06.png" alt="FILES"></p><h2 id="7-フォルダー内には以下のようなファイルが入っています。"><a href="#7-フォルダー内には以下のようなファイルが入っています。" class="headerlink" title="7. フォルダー内には以下のようなファイルが入っています。"></a>7. フォルダー内には以下のようなファイルが入っています。</h2><p><img src="/blog/sharepoint-online/use-sp-modernization-scanner/SMS07.png" alt="FILES1"></p><h2 id="8-ModernizationWorkflowScanResults-csv-を開きます。"><a href="#8-ModernizationWorkflowScanResults-csv-を開きます。" class="headerlink" title="8. ModernizationWorkflowScanResults.csv を開きます。"></a>8. ModernizationWorkflowScanResults.csv を開きます。</h2><p>日本語が含まれる場合は、一度ファイルをメモ帳で開いて、名前を付けて保存し、UTF8 BOM 付きで保存しなおし、その後 Excel で開きます。</p><p><img src="/blog/sharepoint-online/use-sp-modernization-scanner/SMS08-1.png" alt="FILES2"></p><p>Windows 10 以前の OS をご利用の場合は UTF-8 (BOM 付き) の文字コードが指定できない場合があります。この場合は、UTF-8 として上書き保存すれば明示的に BOM が指定されます。<br>手順 9 で Excel データが文字化けしている場合は、この手順がスキップされていることに起因します。</p><h2 id="9-シート上のセルをテーブルに変換し、フィルターを使用して、置き換え対象のワークフローを絞り込んでいきます。"><a href="#9-シート上のセルをテーブルに変換し、フィルターを使用して、置き換え対象のワークフローを絞り込んでいきます。" class="headerlink" title="9. シート上のセルをテーブルに変換し、フィルターを使用して、置き換え対象のワークフローを絞り込んでいきます。"></a>9. シート上のセルをテーブルに変換し、フィルターを使用して、置き換え対象のワークフローを絞り込んでいきます。</h2><p><img src="/blog/sharepoint-online/use-sp-modernization-scanner/SMS09.png" alt="EXCEL1"></p><p>例</p><ul><li>SharePoint 2010 形式ワークフロー (Version = 2010)</li><li>リストで新規インスタンスを許可されている (Enabled = True) </li></ul><p><img src="/blog/sharepoint-online/use-sp-modernization-scanner/SMS10.png" alt="EXCEL2"></p><p>この時点で、使用中のワークフロー一覧については抽出完了です。<br>サイト コレクション管理者にコンテンツを委任している場合は、各サイト コレクション管理者に MC217999 の内容や告示内容、各サイト コレクションごとの抽出データとあわせ、Admins 列に格納されたユーザーに共有して連携してください。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;今回の投稿では、SharePoint Online における &lt;a href=&quot;https://support.microsoft.com/ja-jp/office/1ca3fff8-9985-410a-85aa-8120f626965f?ui=ja-jp&amp;rs=ja-jp</summary>
      
    
    
    
    
    <category term="SharePoint Online" scheme="https://jpspsupport.github.io/blog/tags/SharePoint-Online/"/>
    
  </entry>
  
  <entry>
    <title>HTTP 調整のリトライロジックのテスト方法</title>
    <link href="https://jpspsupport.github.io/blog/sharepoint-online/Testing-backoff-logic/"/>
    <id>https://jpspsupport.github.io/blog/sharepoint-online/Testing-backoff-logic/</id>
    <published>2020-06-07T15:00:00.000Z</published>
    <updated>2022-06-20T04:12:12.491Z</updated>
    
    <content type="html"><![CDATA[<h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><p>HTTP 調整リトライ ロジックを実装した際に、特に弊社公開記事に記載されたカスタムコードを変更している場合は、論理テストを実施していただく必要があります。</p><p>残念ながら、SharePoint Online に対して明示的に調整を発生させることはできないため、現実的なシナリオに即したテストなどを実施することはできません。<br>テストのためにクラウド側に不要な負荷をかけることも適切ではない行動となります。<br>そのため、基本的には論理テストを実施し、様々な想定シナリオに対するロジック テストをパスした後で、テスト済みのコードをマスターに組み込むという方法が現実的です。</p><p>今回の記事では、その疑似的な論理テストを実施する方法の 1 つをご紹介します。</p><h1 id="対処策"><a href="#対処策" class="headerlink" title="対処策"></a>対処策</h1><p>Fiddler の AutoResponder を使用して、CSOM などの通信に対して、任意の HTTP 応答を返して動作検証する方法があります。</p><p>まず、Fiddler を起動し、トレースを取得しておきます。</p><p><img src="/blog/sharepoint-online/Testing-backoff-logic/Fiddler1.png" alt="Fiddler1"></p><ol><li>応答を書き換えたい通信を、画面左ペインから選択します。</li><li>[AutoResponder] タブをクリックします。</li><li>Enable Rules と Unmatched requests passthrough がチェックされていることを確認します。</li><li>[Add Rule] をクリックします。</li></ol><p>次に緑の欄の設定に移ります。</p><p><img src="/blog/sharepoint-online/Testing-backoff-logic/Fiddler2.png" alt="Fiddler2"></p><ol start="5"><li>Rule Editor の下のセレクトボックスで [Create New Response…] をプルダウンから選択します。</li><li>[Save] をクリックすると、ダイアログがポップアップされます。</li></ol><p><img src="/blog/sharepoint-online/Testing-backoff-logic/Fiddler3-1.png" alt="Fiddler3-1"></p><ol start="7"><li><p>[Raw] タブをクリックします。</p></li><li><p>HTTP 応答のステータス コードに 429 TOO MANY REQUESTS を指定します。</p></li><li><p>HTTP 応答ヘッダーに Retry-After を指定して、任意の数値を指定します。<br>テスト用ですので、短い値でも問題ありません。</p></li><li><p>[Save] をクリックします。</p></li><li><p>ダイアログを [x] を押して閉じます。</p></li></ol><p>この後、Fiddler を起動してロジックをテストしてください。指定された間隔でリトライが実行されることが確認できます。</p><p><img src="/blog/sharepoint-online/Testing-backoff-logic/Fiddler4.png" alt="Fiddler4"></p><h1 id="参考リンク"><a href="#参考リンク" class="headerlink" title="参考リンク"></a>参考リンク</h1><p>タイトル : SharePoint Online で調整またはブロックを回避する方法<br>アドレス : <a href="https://docs.microsoft.com/ja-jp/sharepoint/dev/general-development/how-to-avoid-getting-throttled-or-blocked-in-sharepoint-online">https://docs.microsoft.com/ja-jp/sharepoint/dev/general-development/how-to-avoid-getting-throttled-or-blocked-in-sharepoint-online</a></p><p>タイトル : SharePoint Online の HTTP 調整 (応答コード 429, 503) に関して<br>アドレス : <a href="https://social.msdn.microsoft.com/Forums/ja-JP/8e5a4116-c96a-4d3e-9bbf-6efb852b5d88/sharepoint-online-12398-http-3551925972-2454031572124671254012489-429-503?forum=sharepointsupportteamja">https://social.msdn.microsoft.com/Forums/ja-JP/8e5a4116-c96a-4d3e-9bbf-6efb852b5d88/sharepoint-online-12398-http-3551925972-2454031572124671254012489-429-503?forum=sharepointsupportteamja</a></p><p>タイトル : [再改訂版] SharePoint Online HTTP 調整 (応答コード : 429) 対策の増分バックオフ リトライ<br>アドレス : <a href="https://social.msdn.microsoft.com/Forums/sqlserver/ja-JP/21e2a628-44be-4541-bca9-b81c484ff59b/20877259133533029256-sharepoint-online-http-3551925972?forum=sharepointsupportteamja">https://social.msdn.microsoft.com/Forums/sqlserver/ja-JP/21e2a628-44be-4541-bca9-b81c484ff59b/20877259133533029256-sharepoint-online-http-3551925972?forum=sharepointsupportteamja</a></p><p>タイトル : jpspsupport/CSOMRetrySample<br>アドレス : <a href="https://github.com/jpspsupport/CSOMRetrySample">https://github.com/jpspsupport/CSOMRetrySample</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;背景&quot;&gt;&lt;a href=&quot;#背景&quot; class=&quot;headerlink&quot; title=&quot;背景&quot;&gt;&lt;/a&gt;背景&lt;/h1&gt;&lt;p&gt;HTTP 調整リトライ ロジックを実装した際に、特に弊社公開記事に記載されたカスタムコードを変更している場合は、論理テストを実施していただく</summary>
      
    
    
    
    
    <category term="SharePoint Online" scheme="https://jpspsupport.github.io/blog/tags/SharePoint-Online/"/>
    
  </entry>
  
  <entry>
    <title>PnP PowerShell でテナントのフルコントロール権限を使用して接続する方法について</title>
    <link href="https://jpspsupport.github.io/blog/sharepoint-online/pnp-powershell-with-app-only-token/"/>
    <id>https://jpspsupport.github.io/blog/sharepoint-online/pnp-powershell-with-app-only-token/</id>
    <published>2020-05-20T15:00:00.000Z</published>
    <updated>2022-06-20T04:12:12.495Z</updated>
    
    <content type="html"><![CDATA[<h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><p>テナント管理者として、PowerShell でテナント全体のサイト コンテンツに対し、何らかの操作を実施しようとした際には、アクセス権の問題が頻繁に浮上します。</p><p>Office 365 管理センターで指定した全体管理者または SharePoint 管理者の権限がある場合、あらゆる設定を実施することは可能です。<br>しかし、サイト コレクション管理者を別の管理者に委任している場合、自身に該当サイトの管理者権限が与えられていないと、そのままの状態でサイトの変更をしたりコンテンツを閲覧できるわけではありません。</p><p><img src="/blog/sharepoint-online/pnp-powershell-with-app-only-token/SiteCollectionAdminImage.png" alt="SiteCollectionAdminImage"></p><p>このような状況においては、何かテナント単位で各サイトに対する作業を実施しようとした際に、一時的に自分に各サイト コレクションの管理者権限を付与してから作業せざるを得ない状況に陥ります。SharePoint 管理ポータルや、Set-SPOUser -IsSiteCollectionAdmin $true などで設定は可能です。<br>しかし、多くのサイト コレクションの列挙など、一般的にこの追加実装や作業は、時間がかかることが予測されます。</p><h1 id="対処策"><a href="#対処策" class="headerlink" title="対処策"></a>対処策</h1><p>アプリ専用トークンを使用して、アプリにテナントに対する管理者権限を割り当てることができます。手順は以下のサイトにも記載があります。より詳細な情報については確認ください。</p><p>タイトル : SharePoint アプリ専用のアクセスを許可する<br>アドレス : <a href="https://docs.microsoft.com/ja-jp/sharepoint/dev/solution-guidance/security-apponly-azureacs">https://docs.microsoft.com/ja-jp/sharepoint/dev/solution-guidance/security-apponly-azureacs</a></p><h2 id="手順"><a href="#手順" class="headerlink" title="手順"></a>手順</h2><h3 id="1-ブラウザーで-https-tenant-sharepoint-com-layouts-15-appregnew-aspx-を呼び出します。"><a href="#1-ブラウザーで-https-tenant-sharepoint-com-layouts-15-appregnew-aspx-を呼び出します。" class="headerlink" title="1) ブラウザーで https://{tenant}.sharepoint.com/_layouts/15/appregnew.aspx を呼び出します。"></a>1) ブラウザーで https://{tenant}.sharepoint.com/_layouts/15/appregnew.aspx を呼び出します。</h3><p>{tenant} の部分は、ご利用のテナント プリフィックスに基づいたアドレスに変えてください。</p><h4 id="イメージ"><a href="#イメージ" class="headerlink" title="イメージ"></a>イメージ</h4><p><img src="/blog/sharepoint-online/pnp-powershell-with-app-only-token/appregnew.png" alt="AppRegNew"></p><p> 1-1) クライアント ID とクライアント シークレットにて、それぞれ [生成] をクリックします。<br> 1-2) タイトルに任意の名前をしています。<br> 1-3) アプリドメインとリダイレクト先の URI には、指定のようにダミー値を記載します。<br>  (サーバー利用しませんので、ダミーで問題ありません。)<br> 1-4) [作成] をクリックします。<br> <strong>1-5) 次の画面で表示されるアプリの情報を厳重に保管してください。</strong></p><h3 id="2-次にブラウザーで-https-tenant-admin-sharepoint-com-layouts-15-appinv-aspx-を呼び出します。"><a href="#2-次にブラウザーで-https-tenant-admin-sharepoint-com-layouts-15-appinv-aspx-を呼び出します。" class="headerlink" title="2) 次にブラウザーで https://{tenant}-admin.sharepoint.com/_layouts/15/appinv.aspx を呼び出します。**"></a>2) 次にブラウザーで https://{tenant}-admin.sharepoint.com/_layouts/15/appinv.aspx を呼び出します。**</h3><p> 2-1) アプリ ID に、先ほど登録したクライアント ID を入力して、アプリの情報を呼び出します。<br> 2-2) アプリのアクセス許可を付与するために XML を記載します。</p> <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">AppPermissionRequests</span> <span class="attr">AllowAppOnlyPolicy</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">AppPermissionRequest</span> <span class="attr">Scope</span>=<span class="string">&quot;http://sharepoint/content/tenant&quot;</span> <span class="attr">Right</span>=<span class="string">&quot;FullControl&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">AppPermissionRequests</span>&gt;</span></span><br></pre></td></tr></table></figure><p> 2-3) [作成] をクリックします。 </p><h4 id="イメージ-1"><a href="#イメージ-1" class="headerlink" title="イメージ"></a>イメージ</h4><p><img src="/blog/sharepoint-online/pnp-powershell-with-app-only-token/appinv.png" alt="AppInv"></p><p> 2-4) [信頼する] をクリックします。</p><h4 id="イメージ-2"><a href="#イメージ-2" class="headerlink" title="イメージ"></a>イメージ</h4><p><img src="/blog/sharepoint-online/pnp-powershell-with-app-only-token/appinv2.png" alt="AppInv2"></p><p> 2-5) テナントでレガシーのアプリ専用トークンを有効化します。<br>   2020 年夏頃以降に新規作成したテナントにおいて、アプリ専用トークンが既定で無効化されている場合があります。その場合は <a href="https://support.microsoft.com/ja-jp/office/c16941c3-19b4-4710-8056-34c034493429">SharePoint Online 管理シェル</a> を使用してテナントの設定を変更ください。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Set-SPOTenant</span> <span class="literal">-DisableCustomAppAuthentication</span> <span class="variable">$FALSE</span></span><br></pre></td></tr></table></figure><h3 id="3-PnP-PowerShell-で以下のように接続します。後は、続けてコマンドレットを実行ください。"><a href="#3-PnP-PowerShell-で以下のように接続します。後は、続けてコマンドレットを実行ください。" class="headerlink" title="3) PnP PowerShell で以下のように接続します。後は、続けてコマンドレットを実行ください。"></a>3) PnP PowerShell で以下のように接続します。後は、続けてコマンドレットを実行ください。</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Connect-PnPOnline</span> https://&#123;tenant&#125;.sharepoint.com <span class="literal">-ClientId</span> &lt;クライアント ID&gt; <span class="literal">-ClientSecret</span> &lt;クライアント シークレット&gt;</span><br></pre></td></tr></table></figure><h1 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h1><p>アプリ専用トークンは、非常に強力です。しかし、クライアント ID やシークレットとなる情報に尽きましては、管理者アカウント・パスワードと同様、厳重に管理してくださいますようお願いします。</p><h1 id="その他"><a href="#その他" class="headerlink" title="その他"></a>その他</h1><p>Get-PnPContext コマンドを実行することで、ClientContext オブジェクトを取得できるため、このオブジェクトから利用できる様々な処理を実行することが可能です。<br>運用シナリオに応じて、CSOM 標準で用意されているコマンドレットとは別の処理を実行することができます。</p><h1 id="参考リンク"><a href="#参考リンク" class="headerlink" title="参考リンク"></a>参考リンク</h1><p>タイトル : SharePoint PnP の位置づけ<br>アドレス : <a href="https://social.msdn.microsoft.com/Forums/ja-JP/f19d79d3-c6e4-4914-9a8b-580c5efdbf9e/sharepoint-pnp1239820301326222018412369?forum=sharepointsupportteamja">https://social.msdn.microsoft.com/Forums/ja-JP/f19d79d3-c6e4-4914-9a8b-580c5efdbf9e/sharepoint-pnp1239820301326222018412369?forum=sharepointsupportteamja</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;背景&quot;&gt;&lt;a href=&quot;#背景&quot; class=&quot;headerlink&quot; title=&quot;背景&quot;&gt;&lt;/a&gt;背景&lt;/h1&gt;&lt;p&gt;テナント管理者として、PowerShell でテナント全体のサイト コンテンツに対し、何らかの操作を実施しようとした際には、アクセス権の問題</summary>
      
    
    
    
    
    <category term="SharePoint Online" scheme="https://jpspsupport.github.io/blog/tags/SharePoint-Online/"/>
    
  </entry>
  
  <entry>
    <title>SharePoint Online でモダン エクスペリエンスを利用するメリット</title>
    <link href="https://jpspsupport.github.io/blog/sharepoint-online/modern-experience-advantage/"/>
    <id>https://jpspsupport.github.io/blog/sharepoint-online/modern-experience-advantage/</id>
    <published>2020-04-20T15:00:00.000Z</published>
    <updated>2022-06-20T04:12:12.495Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>この記事は、<a href="https://social.msdn.microsoft.com/Forums/ja-JP/0b9b82cb-9826-4387-942b-954b68602128/sharepoint-online-?forum=sharepointsupportteamja">以前の SharePoint サポート フォーラムの投稿</a>を移行したものです。元の記事の最新の更新情報については、本内容をご参照ください。</p></blockquote><p>SharePoint Online は複数の機能において、現在モダン エクスペリエンス/クラシック エクスペリエンスの 2 種類を提供しています。</p><p>クラシック エクスペリエンスを廃止する予定は現時点ではありませんが、SharePoint Online においてはモダン エクスペリエンスの利用を推奨しています。</p><p>今回はモダン エクスペリエンスが推奨される背景を紹介します。今後 SharePoint Online を快適にご利用頂くためにはモダン エクスペリエンスの利用を推奨していますので、本稿の内容を参考に、モダン エクスペリエンスの採用や移行を検討いただけると幸いです。</p><br/><h2 id="モダン-エクスペリエンスが提供された背景"><a href="#モダン-エクスペリエンスが提供された背景" class="headerlink" title="モダン エクスペリエンスが提供された背景"></a>モダン エクスペリエンスが提供された背景</h2><p>SharePoint はオンプレミス向けのサービスとして提供が開始されており、SharePoint Online はオンプレミス向けの SharePoint をベースに、クラウドの SaaS サービスとして提供が開始されました。</p><p>その後、Office 365 の普及に伴い SharePoint Online の利用者も大きく増加しています。データセンターも規模が拡大しており、SharePoint Online が稼働するインフラもサービス開始時とは大きく異なっています。</p><br/><p>オンプレミス向けの SharePoint は主にイントラネットでの利用が想定されており、サーバーの台数も一般的には数台から十数台程度となりますが、複数のテナントでインフラを共有する SharePoint Online は大多数のサーバーで稼働しています。</p><p>この様なインフラの違いが影響し、SharePoint Online でオンプレミス向け SharePoint をベースに提供された機能を利用していると、パフォーマンスに影響が生じる事例が散見されるようになりました。</p><p>具体例として、オンプレミス向け SharePoint は主にフロントエンドサーバーのキャッシュを利用してパフォーマンスを維持していましたが、大多数のサーバーで稼働する SharePoint Online ではアクセスが毎回異なるサーバーに分散され、前と同じサーバーにルーティングされる可能性が極めて低いため、フロントエンドサーバーが保持するキャッシュがほとんどヒットしません。</p><p>キャッシュが利用できないため、フロントエンドサーバーやバックエンドデータベースの処理量増加により負荷が大きくなり、テナントのパフォーマンスが劣化した事例が多数あります。</p><p>従来のオンプレミス向けのアーキテクチャではクラウドのインフラでパフォーマンスを維持することが困難となったため、クラウドのインフラに最適化された設計で開発されたのがモダン エクスペリエンスとなります。</p><br/><h2 id="モダン-エクスペリエンスが推奨される理由"><a href="#モダン-エクスペリエンスが推奨される理由" class="headerlink" title="モダン エクスペリエンスが推奨される理由"></a>モダン エクスペリエンスが推奨される理由</h2><p>SharePoint Online はマルチテナント型の SaaS サービスです。つまり、複数のテナントによってインフラが共有されています。<br>また、開発が継続されているため、各テナントに変更が都度反映されています。</p><p>このため、データセンター側の負荷状況の予測は非常に困難となっています。</p><p>モダン エクスペリエンスは、サーバー側の負荷状況の変動が影響しにくいように、以下の様な要素が取り入れられています。</p><br/><ul><li><p>CDN</p><ul><li>静的コンテンツを Office 365 サーバーとは異なるプロキシにキャッシュし、サーバーの負荷を軽減します。</li></ul></li><li><p>クライアントサイド指向</p><ul><li>サーバー側の処理を極力シンプルにし、クライアント側でビジネスロジックを実行します。</li></ul></li><li><p>マイクロサービスアーキテクチャ</p><ul><li>1 つのアプリケーションを、独立した小さいサービスの集合で構成する設計指針。スケーリングが容易で、単一のサービスに問題が生じてもアプリケーション全体に影響が生じにくくなります。</li></ul></li></ul><br/>また、モダン エクスペリエンスは引き続き積極的に開発されているため、機能の追加や修正が積極的に実施されていることも、モダン エクスペリエンスを採用するメリットとなります。<p>クラシック エクスペリエンスはレガシーな基盤である ASP.NET を利用しているため、新しい機能の追加や既存機能の修正が困難となっています。</p><br/>なお、上述の通りクラシック エクスペリエンスが廃止されるアナウンスは現時点ではありませんので、この点についてはご安心ください。<p>しかし、クラシック エクスペリエンスにおいてはパフォーマンスに関する考慮事項が多くあるので、特に多くのユーザーによって利用されるクラシック エクスペリエンスのサイトにおいては、弊社公開情報を参考にパフォーマンスチューニングを実施することを強く推奨します。</p><p>タイトル : SharePoint Online のパフォーマンスをチューニングする<br>アドレス : <a href="https://docs.microsoft.com/ja-jp/office365/enterprise/tune-sharepoint-online-performance">https://docs.microsoft.com/ja-jp/office365/enterprise/tune-sharepoint-online-performance</a></p><p>タイトル : SharePoint Online ポータル パフォーマンス ガイダンス<br>アドレス : <a href="https://docs.microsoft.com/ja-jp/sharepoint/dev/solution-guidance/portal-performance">https://docs.microsoft.com/ja-jp/sharepoint/dev/solution-guidance/portal-performance</a></p><br/><h2 id="クラッシック-モダンエクスペリエンスの対応"><a href="#クラッシック-モダンエクスペリエンスの対応" class="headerlink" title="クラッシック/モダンエクスペリエンスの対応"></a>クラッシック/モダンエクスペリエンスの対応</h2><p>各機能のクラシック エクスペリエンス/モダン エクスペリエンスの対応を紹介します。</p><table><thead><tr><th align="left">クラッシック エクスペリエンス</th><th align="left">モダン エクスペリエンス</th></tr></thead><tbody><tr><td align="left">チームサイト、発行ポータル、など</td><td align="left">モダンチームサイト、コミュニケーションサイト、ハブサイトなど</td></tr><tr><td align="left">サンドボックス ソリューション<br/>スクリプト エディター/コンテンツ エディター Web パーツ</td><td align="left">SharePoint Framework</td></tr><tr><td align="left">アンケートリスト</td><td align="left">Microsoft Forms</td></tr><tr><td align="left">タスクリスト</td><td align="left">Microsoft Planner</td></tr><tr><td align="left">予定表リスト</td><td align="left">Outlook Calendar (Office 365 Groups)</td></tr><tr><td align="left">ニュース（サイト）フィード、ディスカッション掲示板</td><td align="left">Yammer</td></tr><tr><td align="left">SharePoint ワークフロー</td><td align="left">Microsoft Flow (Power Automate)</td></tr><tr><td align="left">InfoPath</td><td align="left">Microsoft PowerApps</td></tr></tbody></table><br/>モダン エクスペリエンスはクラシック エクスペリエンスの機能を完全に包括するものではありませんが、モダン エクスペリエンスでのみ実現可能なことも多数あります。<p>一例として、クラシック エクスペリエンスで慎重に考慮する必要があったリストビューのしきい値が、モダン エクスペリエンスでは抵触しにくくなっています。</p><p>これは新しいアーキテクチャによって最適化されたデータアクセスを実現しているため、しきい値自体は存在するものの、多くの場合に抵触しにくい実装となっています。</p><p>本稿ではそれぞれの差異についての紹介は割愛しますが、是非動作をご確認いただき、長期的に SharePoint Online を快適にご利用頂くためには、モダン エクスペリエンスの採用を検討いただけると幸いです。</p><br/><p><em>追記</em></p><p>SharePoint Online でモダン エクスペリエンスをご利用いただく際のガイダンスとなる情報が公開されました。</p><p>タイトル : SharePoint でのモダンな機能のガイド<br>アドレス : <a href="https://docs.microsoft.com/ja-jp/sharepoint/guide-to-sharepoint-modern-experience">https://docs.microsoft.com/ja-jp/sharepoint/guide-to-sharepoint-modern-experience</a></p><p>モダン エクスペリエンスをご利用を検討される場合、こちらの情報も事前にご確認いただけると幸いです。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;この記事は、&lt;a href=&quot;https://social.msdn.microsoft.com/Forums/ja-JP/0b9b82cb-9826-4387-942b-954b68602128/sharepoint-online-?forum=</summary>
      
    
    
    
    
    <category term="SharePoint Online" scheme="https://jpspsupport.github.io/blog/tags/SharePoint-Online/"/>
    
  </entry>
  
  <entry>
    <title>SharePoint Support チームのブログへようこそ</title>
    <link href="https://jpspsupport.github.io/blog/general/welcome/"/>
    <id>https://jpspsupport.github.io/blog/general/welcome/</id>
    <published>2020-04-13T15:00:00.000Z</published>
    <updated>2022-06-20T04:12:12.491Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>本記事は Technet Blog の更新停止に伴い、もともとばらばらに存在していた記事を一つのブログに集約／移行したものです。<br>元の記事の最新の更新情報については、本ブログの投稿をご参照ください。</p></blockquote><p>こんにちは。<br>SharePoint Support チームのブログです。</p><p>わたしたちサポートチームでは下記の製品のサポートを行っており、それぞれの製品に関する情報を本ブログで発信していきたいと考えています。</p><ul><li>SharePoint Online と OneDrive for Business</li><li>SharePoint Server (オンプレミス)</li><li>Microsoft Stream</li></ul><p>なお、本ブログは弊社の公式見解ではなく、予告なく変更される場合があります。<br>もし公式な見解が必要な場合は、弊社ドキュメント (<a href="https://docs.microsoft.com/">https://docs.microsoft.com/</a> や <a href="https://support.microsoft.com/">https://support.microsoft.com</a>) をご参照いただく、もしくは私共サポートまでお問い合わせください。</p><p>本情報が少しでも皆様のお役に立てば幸いです😊</p><p>※過去のブログ記事は以下にアーカイブされております。<br>過去の記事を参照いただく際は、それぞれのリンク先から検索ください。<br>元の記事の最新の更新情報については、本ブログに掲載いたします。</p><ul><li><a href="https://social.msdn.microsoft.com/Forums/ja-JP/home?forum=sharepointsupportteamja">以前の SharePoint サポート フォーラムの投稿</a></li><li><a href="https://docs.microsoft.com/en-us/archive/blogs/sharepoint_support/">以前の Japan SharePoint Support Team Blog</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;本記事は Technet Blog の更新停止に伴い、もともとばらばらに存在していた記事を一つのブログに集約／移行したものです。&lt;br&gt;元の記事の最新の更新情報については、本ブログの投稿をご参照ください。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;</summary>
      
    
    
    
    
  </entry>
  
</feed>
